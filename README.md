##  1. Аналіз рекламних компаній Google та Facebook
[Перегляньте код за посиланням](https://github.com/RomanHresko/SQL/blob/main/SQL)

- Створено запит для отримання інформації про метрики кампаній та наборів оголошень у відповідні дні для Google та Facebook.
- Об'єднано 2 таблиці за допомогою UNION ALL, далі створено CTE.
- З отриманого CTE здійснено вибірку ad_date, utm_campaign, url_parameters (зведено до нижнього регістру), пусті значення  utm_campaign в utm_parameters дорівнює ‘nan’.
- Здійснено розрахунок CTR, CPC, CPM, ROMI та агрегацію даних у відповідну дату по відповідній кампанії. 

## 2. Кодування рядків в URL
В значеннях поля utm_parameters кириличні літери закодовані в URL-рядок. Декодування значення utm_campaign за допомогою створення тимчасової функції

## 3. Робота з датами і часом та віконні функції
- Використано вже раніше створену CTE
- ad_month знайдено перше число місяця за допомогою функції "date_trunc('month', ad_date) AS ad_month"
-  Створено результуючу вибірку: d_month, utm_campaign, загальна сума витрат, кількість показів, кількість кліків, value конверсій, CTR, CPC, CPM, ROMI.
-  Для кожної utm_campaign в кожен місяць додано нове поле: ‘різниця CPM, CTR та ROMI’  в поточному місяці відносно наявного попереднього у відсотках за допомогою віконних функцій.

## 4. Основні SQL-оператори й функції:
- CTE (Common Table Expressions): тимчасові результати, визначені в запиті.
- JOIN і UNION: для об'єднання таблиць.
- COALESCE: заміна відсутніх значень.
- CASE: умови для уникнення ділення на нуль, перевірка умов та повернення значень коли виконуються умови.
- LAG: для порівняння метрик за місяцями.
- SUM, ROUND: агрегатні функції для розрахунків.
- DATE_TRUNC: виділення потрібної частини дати (YEAR, MONTH, DAY).
- GROUP BY: групування.
- OVER  і PARTITION BY, LEAD, LAG, RANK, DENSE_RANK: віконні функції.




## 5. BigQuery 
1. Запит про події, користувачів та сесії в GA4 за 2021 рік.
2. Розрахунок конверсій в розрізі дат та каналів трафіку від початку сесії до покупки.
   Посилання на запит:
https://console.cloud.google.com/bigquery?sq=135017838998:9cceda3f33c649af90a4ea2235b09fa2&pli=1&inv=1&invt=AbzB-g&project=for-youtube-looker-458011&ws=!1m4!1m3!8m2!1s135017838998!2s9cceda3f33c649af90a4ea2235b09fa2
